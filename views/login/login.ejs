<!DOCTYPE html>
<html lang="pt-BR">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Login</title>
    <link rel="stylesheet" href="/css/elogin.css">
</head>

<body>

    <div class="page">
        <form method="POST" action="/" class="formLogin">
            <img src="/imagens/logo.png" alt="logo">

            <input type="text" id="email" name="email" placeholder="Digite seu e-mail ou matrícula" required />
            <input type="password" id="senha" name="senha" placeholder="Digite sua senha" required />

            <a href="/esqueci-senha"
                style="font-size: 0.9rem; display: block; margin-top: 10px; color: rgb(0, 0, 0)">Esqueceu a senha?</a>

            <input type="submit" value="Entrar" class="entrar" />

            <p class="cadastro-texto">
                Não possui login? <a href="/cadastro" class="link-cadastro">Cadastre-se!</a>
            </p>
        </form>
    </div>

    <div class="rodape">
        <div class="carrossel">
            <span id="frase" aria-live="polite"></span>
        </div>
    </div>

    <div id="alert" class="alert" style="<%= erro ? 'display:flex' : 'display:none' %>">
        <%= erro %>
            <span id="close-alert">&times;</span>
    </div>

    <div id="logo"></div>

    <!-- Script do carrossel de frases -->
    <script>
        document.addEventListener("DOMContentLoaded", () => {
            const frases = [
                "“Não se pode falar de educação sem amor.” — Paulo Freire.",
                "“A infância é a idade das interrogações, a juventude a das afirmações, a velhice a das negações.” — George Sand.",
                "“Brincar é o trabalho da infância.” — Jean Piaget.",
                "“Ensinar não é transferir conhecimento, mas criar as possibilidades para a sua própria produção ou a sua construção.” — Paulo Freire.",
                "“São as crianças, que sem falar, nos ensinam as razões para viver. Elas não têm saberes a transmitir. No entanto, elas sabem o essencial da vida.” — Rubem Alves.",
                "“A fim de que a educação seja eficaz e afetiva, deve-se respeitar o tempo e o ritmo de cada criança.” — Jean Piaget."
            ];

            const fraseElemento = document.getElementById("frase");
            if (!fraseElemento) return;

            // Função para "normalizar" texto (remove espaços extras e unifica aspas)
            const normaliza = (s) => String(s || "")
                .replace(/[“”"]/g, '"')
                .replace(/\s+/g, " ")
                .trim()
                .toLowerCase();

            // Se o array estiver vazio, nada a fazer
            if (frases.length === 0) {
                fraseElemento.textContent = "";
                return;
            }

            // Inicializa o elemento com a primeira frase do array (fonte única de verdade)
            fraseElemento.textContent = frases[0];
            fraseElemento.classList.add("mostrar");

            // índice aponta para próxima frase a ser exibida
            let idx = 1 % frases.length;

            // troca com fade; pula frases iguais à exibida atualmente
            function proxima(fraseIndex) {
                // prepara próximo índice que não duplica o texto atual
                let tentativas = 0;
                const textoAtualNorm = normaliza(fraseElemento.textContent);
                while (normaliza(frases[fraseIndex]) === textoAtualNorm && tentativas < frases.length) {
                    fraseIndex = (fraseIndex + 1) % frases.length;
                    tentativas++;
                }
                // se todas as frases são iguais (caso limite), não faz nada
                if (tentativas >= frases.length && normaliza(frases[fraseIndex]) === textoAtualNorm) return (idx = (fraseIndex + 1) % frases.length);

                // fade out -> troca -> fade in
                fraseElemento.classList.remove("mostrar");
                setTimeout(() => {
                    fraseElemento.textContent = frases[fraseIndex];
                    fraseElemento.classList.add("mostrar");
                }, 600); // tem que bater com a transição CSS (600ms)

                // atualiza índice para próxima chamada
                idx = (fraseIndex + 1) % frases.length;
            }

            // Inicia ciclo: troca a cada 10s, a primeira troca após 10s
            const intervalo = 10000;
            setInterval(() => proxima(idx), intervalo);
        });
    </script>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const alertBox = document.getElementById('alert');
            const closeBtn = document.getElementById('close-alert');

            if (closeBtn) {
                closeBtn.addEventListener('click', () => {
                    alertBox.style.display = 'none';
                });
            }

            // Auto-fechar após 4 segundos
            if (alertBox) {
                setTimeout(() => {
                    alertBox.style.display = 'none';
                }, 4000);
            }
        });
    </script>
</body>

</html>